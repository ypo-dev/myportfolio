<template>
  <div id="app">
    <vue-playback  v-if="isshow" ref="mycom" :range="0.5" :WIDTH="1600" :HEIGHT="100" :type="type" :websocketURL="url4" :id="selectid" :arraybuffer="arraybuffer" @currentTimeEnded="currenttime" @durationEnded="duration"></vue-playback>
    插入文件<input type="file"  @change="addFile" ref="file">
    选择设备id<select v-model="selectid">
      <option :value="5">5</option>
      <option :value="8">8</option>
      <option :value="9">9</option>
      <option :value="10">10</option>
      <option :value="11">11</option>
      <option :value="12">12</option>
      <option :value="263">263</option>
      <option :value="264">264</option>
      <option :value="265">265</option>
      <option :value="10302">10302</option>
    </select>
    选择类型<select v-model="type">
      <option value="line3">line3</option>
      <option value="line2">line2</option>
      <option value="line">line</option>
      <option value="bar">bar</option>
    </select>
    <button @click="load">load</button>
    <button @click="play">play</button>
    <button @click="pause">pause</button>
    <button @click="stop">stop</button>
    <button @click="show">show</button>
    <input type="number" v-model="input" >
    <button @click="btn">seek</button>
  </div>
</template>

<script type="text/ecmascript-6">
export default {
  name: 'wsy',
  data() {
    return {
      seek: 0,
      input: 0,
      selectid: 5,
      arraybuffer: undefined,
      type: 'line3',
      isshow: true,
      url1: 'ws://192.168.6.41:8081/ws/websocket/socketServer.do',
      url2: 'ws://192.168.6.150:9999/getAudioBuff',
      url3: 'ws://192.168.6.150:8085/asrTransfer',
      url4: 'ws://192.168.6.221:9999/getAudioBuff'
    }
  },
  methods: {
    currenttime(e) {
      console.log(`currenttime = ${e}`)
    },
    duration(e) {
      //console.log(`duration = ${e}`)
    },
    btn() {
      this.$refs.mycom.seekTo(this.input * 1)
    },
    show() {
      this.isshow = !this.isshow
    },
    addFile() {
      let myfile = this.$refs.file.files[0]
      let _this = this
      if (myfile) {
        let fileReader = new FileReader()
        fileReader.onload = function(e) {
          let fileContent = e.target.result
          _this.arraybuffer = fileContent
        }
        fileReader.readAsArrayBuffer(myfile)
      }
    },
    load() {
      this.$refs.mycom.openWS()
    },
    play() {
      this.$refs.mycom.play()
    },
    pause() {
      this.$refs.mycom.pause()
    },
    stop() {
      this.$refs.mycom.stop()
    }
  }
}
</script>

<style scoped lang="stylus" rel="stylesheet/stylus">

</style>
