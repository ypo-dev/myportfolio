<template>
  <div id="app">
    <vue-transfer @currentTimeEnded="currenttime" v-if="isshow" ref="mycom" :range="0.3" :WIDTH="930"  :HEIGHT="128" :type="type" :websocketURL="url2" :id="selectid" :arraybuffer="arraybuffer"></vue-transfer>
    <!-- 插入文件<input type="file"  @change="addFile" ref="file"> -->
    选择设备id<select v-model="selectid">
      <option :value="21">21</option>
      <option :value="76">76</option>
      <option :value="197">197</option>
    </select>
    选择类型<select v-model="type">
      <option value="line3">line3</option>
      <option value="line2">line2</option>
      <option value="line">line</option>
      <option value="bar">bar</option>
    </select>
    <button @click="load">load</button>
    <button @click="play">play</button>
    <button @click="pause">pause</button>
    <button @click="stop">stop</button>
    <button @click="show">show</button>
  </div>
</template>

<script type="text/ecmascript-6">
export default {
  name: 'wsy',
  data() {
    return {
      selectid: 21,
      arraybuffer: undefined,
      type: 'line3',
      isshow: true,
      url1: 'ws://192.168.6.41:8081/ws/websocket/socketServer.do',
      url2: 'ws://192.168.6.150:9999/getAudioBuff',
      url3: 'ws://192.168.6.220:9999/getAudioBuff'
    }
  },
  methods: {
    show() {
      this.isshow = !this.isshow
    },
    currenttime(e) {
      //console.log(`currenttime = ${e}`)
    },
    addFile() {
      let myfile = this.$refs.file.files[0]
      let _this = this
      if (myfile) {
        let fileReader = new FileReader()
        fileReader.onload = function(e) {
          let fileContent = e.target.result
          _this.arraybuffer = fileContent
        }
        fileReader.readAsArrayBuffer(myfile)
      }
    },
    load() {
      this.$refs.mycom.openWS()
    },
    play() {
      this.$refs.mycom.play()
    },
    pause() {
      this.$refs.mycom.pause()
    },
    stop() {
      this.$refs.mycom.stop()
    }
  }
}
</script>

<style scoped lang="stylus" rel="stylesheet/stylus">

</style>
